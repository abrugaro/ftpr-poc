name: CI

on:
  push:
    branches: [ main, develop, feature/** ]
  pull_request:
    branches: [ main, develop ]

jobs:
  quality-check:
    name: Quality Check
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Check CI Control
      run: |
        if [ ! -f .ci-control ]; then
          echo "✅ No .ci-control file found - CI will PASS by default"
          exit 0
        fi

        CONTROL_CONTENT=$(cat .ci-control | tr -d '[:space:]' | tr '[:upper:]' '[:lower:]')
        echo "CI Control file content: '$CONTROL_CONTENT'"

        if [ "$CONTROL_CONTENT" = "fail" ]; then
          echo "❌ CI Control set to FAIL - Failing intentionally"
          exit 1
        elif [ "$CONTROL_CONTENT" = "pass" ]; then
          echo "✅ CI Control set to PASS - Passing"
          exit 0
        else
          echo "⚠️  Unknown CI control value: '$CONTROL_CONTENT' - Defaulting to PASS"
          exit 0
        fi
